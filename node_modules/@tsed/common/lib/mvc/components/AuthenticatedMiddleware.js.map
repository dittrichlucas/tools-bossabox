{"version":3,"sources":["mvc/components/AuthenticatedMiddleware.ts"],"names":[],"mappings":";;;AAAA,mCAAmC;AACnC,yDAA4C;AAE5C,wEAAmE;AACnE,wDAAmD;AACnD,8DAAyD;AACzD,gEAA2D;AAC3D,+DAA0D;AAE1D;;;;GAIG;AAEH,IAAa,uBAAuB,GAApC,MAAa,uBAAuB;IAC3B,GAAG,CAAiB,QAA0B,EAAa,OAAwB,EAAU,IAA0B;QAC5H,+DAA+D;QAC/D,MAAM,eAAe,GAAI,OAAe,CAAC,eAAe,CAAC;QAEzD,IAAI,OAAO,eAAe,KAAK,UAAU,EAAE;YACzC,IAAI,CAAC,eAAe,EAAE,EAAE;gBACtB,IAAI,CAAC,IAAI,6BAAS,CAAC,WAAW,CAAC,CAAC,CAAC;gBAEjC,OAAO;aACR;SACF;QAED,IAAI,EAAE,CAAC;IACT,CAAC;CACF,CAAA;AAdC;IAAY,mBAAA,2BAAY,EAAE,CAAA,EAA8B,mBAAA,iBAAO,EAAE,CAAA,EAA4B,mBAAA,WAAI,EAAE,CAAA;;6CAA9D,mCAAgB;;kDAapD;AAdU,uBAAuB;IADnC,uBAAU,EAAE;GACA,uBAAuB,CAenC;AAfY,0DAAuB","file":"AuthenticatedMiddleware.js","sourcesContent":["import * as Express from \"express\";\nimport {Forbidden} from \"ts-httpexceptions\";\nimport {IMiddleware} from \"../\";\nimport {EndpointInfo} from \"../../filters/decorators/endpointInfo\";\nimport {Next} from \"../../filters/decorators/next\";\nimport {Request} from \"../../filters/decorators/request\";\nimport {EndpointMetadata} from \"../class/EndpointMetadata\";\nimport {Middleware} from \"../decorators/class/middleware\";\n\n/**\n * This middleware manage the authentication.\n * @private\n * @middleware\n */\n@Middleware()\nexport class AuthenticatedMiddleware implements IMiddleware {\n  public use(@EndpointInfo() endpoint: EndpointMetadata, @Request() request: Express.Request, @Next() next: Express.NextFunction) {\n    // const options = endpoint.get(AuthenticatedMiddleware) || {};\n    const isAuthenticated = (request as any).isAuthenticated;\n\n    if (typeof isAuthenticated === \"function\") {\n      if (!isAuthenticated()) {\n        next(new Forbidden(\"Forbidden\"));\n\n        return;\n      }\n    }\n\n    next();\n  }\n}\n"],"sourceRoot":"../../../src"}