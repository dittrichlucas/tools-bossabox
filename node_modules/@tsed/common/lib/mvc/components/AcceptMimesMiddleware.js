"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
var AcceptMimesMiddleware_1;
const ts_httpexceptions_1 = require("ts-httpexceptions");
const endpointInfo_1 = require("../../filters/decorators/endpointInfo");
const request_1 = require("../../filters/decorators/request");
const EndpointMetadata_1 = require("../class/EndpointMetadata");
const middleware_1 = require("../decorators/class/middleware");
/**
 * @private
 * @middleware
 */
let AcceptMimesMiddleware = AcceptMimesMiddleware_1 = class AcceptMimesMiddleware {
    use(endpoint, request) {
        const mimes = endpoint.get(AcceptMimesMiddleware_1) || [];
        const find = mimes.find((mime) => request.accepts(mime));
        if (!find) {
            throw new ts_httpexceptions_1.NotAcceptable(mimes.join(", "));
        }
    }
};
tslib_1.__decorate([
    tslib_1.__param(0, endpointInfo_1.EndpointInfo()), tslib_1.__param(1, request_1.Request()),
    tslib_1.__metadata("design:type", Function),
    tslib_1.__metadata("design:paramtypes", [EndpointMetadata_1.EndpointMetadata, Object]),
    tslib_1.__metadata("design:returntype", void 0)
], AcceptMimesMiddleware.prototype, "use", null);
AcceptMimesMiddleware = AcceptMimesMiddleware_1 = tslib_1.__decorate([
    middleware_1.Middleware()
], AcceptMimesMiddleware);
exports.AcceptMimesMiddleware = AcceptMimesMiddleware;

//# sourceMappingURL=AcceptMimesMiddleware.js.map
